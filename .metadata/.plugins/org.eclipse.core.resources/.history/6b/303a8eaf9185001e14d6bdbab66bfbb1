package com.shoplaptop.dao;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import javax.swing.text.rtf.RTFEditorKit;

import com.shoplaptop.entity.HoaDon;
import com.shoplaptop.entity.PhieuDoi;
import com.shoplaptop.utils.XJdbc;

public class PhieuDoiDAO implements ShopLaptop365DAO<PhieuDoi, String>{
		
	String Insert_PhieuDoi = "INSERT dbo.PhieuDoi(MaPhieuDoi,MaKH,MaHD,MaNV,NgayTao,LiDo)VALUES(?,?,?,?,?,?)";
	String Update_PhieuDoi = "UPDATE dbo.PhieuDoi SET NgayTao = ?, LiDo = ? WHERE MaPhieuDoi = ?";
	String Delete_SQL = "DELETE FROM dbo.PhieuDoi WHERE MaPhieuDoi = ?";
//	String SelectCTPhieuDoi_SQL = "SELECT * FROM dbo.CTPhieuDoi";
	
	String SelectPhieuDoi_SQL = "SELECT * FROM dbo.PhieuDoi";
	
	String SelectPhieuDoiByMaPhieuDoi = "SELECT * FROM dbo.PhieuDoi WHERE MaPhieuDoi = ?";
	
	@Override
	public String insert(PhieuDoi phieuDoi) {
		try {
			XJdbc.update(Insert_PhieuDoi, phieuDoi.getMaPhieuDoi(),phieuDoi.getMaKH(),phieuDoi.getID_HoaDon(),phieuDoi.getMaNV(),phieuDoi.getNgayTao(),phieuDoi.getLiDo());
			
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
		return null;
	}
	
	
	@Override
	public String update(PhieuDoi phieuDoi) {
		try {
			XJdbc.update(Update_PhieuDoi, phieuDoi.getNgayTao(), phieuDoi.getLiDo(),phieuDoi.getMaPhieuDoi() );
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
		return null;
	}
	
	
	@Override
	public String delete(String MaPhieuDoi) {
		try {
			XJdbc.update(Delete_SQL, MaPhieuDoi);
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
		return null;
	}
	
	@Override
	public PhieuDoi selectById(String id) {
		List<PhieuDoi> list = this.selectBySQL(SelectPhieuDoiByMaPhieuDoi, id);
		if (list.isEmpty()) {
			return null;
		}
		return list.get(0);
	}

	@Override
	public List<PhieuDoi> selectAll() {
		return this.selectBySQL(SelectPhieuDoi_SQL);
	}
	
	@Override
	public List<PhieuDoi> selectBySQL(String sql, Object... args) {
		List<PhieuDoi> list = new ArrayList<PhieuDoi>();
		try {
			ResultSet rs = XJdbc.query(sql, args);
			while(rs.next()) {
				PhieuDoi phieuDoi = new PhieuDoi();
				phieuDoi.setID(rs.getInt("ID"));
				phieuDoi.setMaPhieuDoi(rs.getString("MaPhieuDoi"));
				phieuDoi.setMaKH(rs.getString("MaKH"));
				phieuDoi.setMaHD(rs.getString("MaHD"));
				phieuDoi.setMaNV(rs.getString("MaNV"));
				phieuDoi.setNgayTao(rs.getDate("NgayTao"));
				phieuDoi.setLiDo(rs.getString("LiDo"));
				list.add(phieuDoi);				
			}
			rs.getStatement().getConnection().close();
			return list;
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
	}
	
	
	
	
}
