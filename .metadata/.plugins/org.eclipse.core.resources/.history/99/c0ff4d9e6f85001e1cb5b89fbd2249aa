package com.shoplaptop.dao;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import com.shoplaptop.entity.CTPhieuDoi;
import com.shoplaptop.entity.PhieuDoi;
import com.shoplaptop.utils.XJdbc;

public class CTPhieuDoiDAO implements ShopLaptop365DAO<CTPhieuDoi, String> {
	String Insert_CTPhieuDoi = "INSERT dbo.CTPhieuDoi(ID_PhieuDoi,ID_Serial_Old,ID_Serial_New)VALUES(?,?,? )";
	String Update_CTPhieuDoi ="UPDATE dbo.CTPhieuDoi SET ID_Serial_New = ? WHERE ID_PhieuDoi = ?";
	String SelectCTPhieuDoi_SQL = "SELECT dbo.PhieuDoi.ID AS 'ID_PhieuDoi', dbo.PhieuDoi.MaPhieuDoi,dbo.Serial.ID AS 'ID_Serial_Old', dbo.Serial.SerialNumber AS 'SerialNumber_Old',\r\n"
			+ "	dbo.Serial.ID AS 'ID_Serial_New', dbo.Serial.SerialNumber AS 'SerialNumber_New'\r\n"
			+ "FROM dbo.CTPhieuDoi JOIN dbo.PhieuDoi ON PhieuDoi.ID = CTPhieuDoi.ID_PhieuDoi\r\n"
			+ "	JOIN dbo.Serial ON Serial.ID = CTPhieuDoi.ID_Serial_Old "
			+ "WHERE PhieuDoi.MaPhieuDoi = ?";
	@Override
	public String insert(CTPhieuDoi ctPhieuDoi) {
		try {
			XJdbc.update(Insert_CTPhieuDoi,ctPhieuDoi.getID_PhieuDoi(), ctPhieuDoi.getID_Serial_Old(),ctPhieuDoi.getID_Serial_New());
			
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
		return null;
		
	}

	@Override
	public String update(CTPhieuDoi ctPhieuDoi) {
		try {
			XJdbc.update(Update_CTPhieuDoi, ctPhieuDoi.getID_Serial_New(),ctPhieuDoi.getID_PhieuDoi() );
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
		return null;
	}

	@Override
	public String delete(String id) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public CTPhieuDoi selectById(String maPhieuDoi) {
//		try {
//			List<CTPhieuDoi> list = this.selectBySQL(selectPhieuDoi, maPhieuDoi);
//			if (list.isEmpty()) {
//				return null;
//			}
//			return list.get(0);
//		} catch (Exception e) {
//			// TODO: handle exception
//		}
		return null;
	}

	@Override
	public List<CTPhieuDoi> selectAll() {
		
		return null;
	}
	public List<CTPhieuDoi> selectAllCTPhieuDoiByMaPhieuDoi(String MaPhieuDoi) {
		
		return selectBySQL(SelectCTPhieuDoi_SQL, MaPhieuDoi);
	}
	

	@Override
	public List<CTPhieuDoi> selectBySQL(String sql, Object... args) {
		List<CTPhieuDoi> list = new ArrayList<CTPhieuDoi>();
		try {
			ResultSet rs = XJdbc.query(sql, args);
			while(rs.next()) {
				CTPhieuDoi ctPhieuDoi = new CTPhieuDoi();
				ctPhieuDoi.setID_PhieuDoi(rs.getInt("ID_PhieuDoi"));
				ctPhieuDoi.setMaPhieuDoi(rs.getString("MaPhieuDoi"));
				ctPhieuDoi.setID_Serial_Old(rs.getInt("ID_Serial_Old"));
				ctPhieuDoi.setSerialNumber_Old(rs.getString("SerialNumber_Old"));
				ctPhieuDoi.setID_Serial_New(rs.getInt("ID_Serial_New"));
				ctPhieuDoi.setSerialNumber_New(rs.getString("SerialNumber_New"));
			}
			rs.getStatement().getConnection().close();
			return list;
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
		
	}
	
	
	
}
